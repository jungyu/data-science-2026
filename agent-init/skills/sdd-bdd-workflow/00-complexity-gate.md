# 複雜度評估關 (Complexity Gate)

> **目的**: 在開始規格撰寫前，先評估功能複雜度，選擇適當的工作流程模式。

## 🎯 核心任務

回答 4 個評估問題，計算總分，決定適用模式。

---

## 📋 評估問卷

### 問題 1: 涉及多少模組/服務？

- 【0 分】單一模組（如：新增一個工具函數、修改單一元件）
- 【2 分】跨模組（如：API + 前端 + 資料庫聯動）

### 問題 2: 有權限/並發/不可逆操作？

- 【0 分】無（如：純讀取、格式轉換、UI 調整）
- 【3 分】有（如：刪除功能、支付流程、權限檢查）

### 問題 3: 涉及 DB Schema 變更？

- 【0 分】否（如：使用現有資料表、只改前端）
- 【2 分】是（如：新增資料表、修改欄位、新增索引）

### 問題 4: 涉及外部 API 整合？

- 【0 分】否（如：內部邏輯、本地處理）
- 【2 分】是（如：第三方 API、Webhook、OAuth）

---

## 📊 分數判定

| 總分 | 模式 | 說明 |
|:----:|------|------|
| 0-2 | **Lite** | 快速迭代，測試即文件 |
| 3-5 | **Standard** | 平衡規格與效率 |
| 6+ | **Full** | 完整三關，確保品質 |

---

## ✅ 範例評估

### 範例 1: 新增工具函數

| 問題 | 答案 | 分數 |
|------|------|:----:|
| 涉及多少模組？ | 1 個（新增 utils 函數）| 0 |
| 有權限/並發/不可逆？ | 無 | 0 |
| 涉及 DB Schema？ | 否 | 0 |
| 涉及外部 API？ | 否 | 0 |
| **總分** | | **0** |

**結論**: Lite 模式 ✅

---

### 範例 2: 新增使用者通知功能

| 問題 | 答案 | 分數 |
|------|------|:----:|
| 涉及多少模組？ | 2+ 個（API + DB + 前端元件）| 2 |
| 有權限/並發/不可逆？ | 有（通知偏好、權限檢查）| 3 |
| 涉及 DB Schema？ | 否（使用現有欄位）| 0 |
| 涉及外部 API？ | 否 | 0 |
| **總分** | | **5** |

**結論**: Standard 模式 ✅

---

### 範例 3: 支付系統整合

| 問題 | 答案 | 分數 |
|------|------|:----:|
| 涉及多少模組？ | 2+ 個（API + DB + Webhook）| 2 |
| 有權限/並發/不可逆？ | 有（金流、交易記錄）| 3 |
| 涉及 DB Schema？ | 是（transactions 表）| 2 |
| 涉及外部 API？ | 是（Stripe API）| 2 |
| **總分** | | **9** |

**結論**: Full 模式 ✅

---

## 🚦 下一步

根據評估結果，前往對應模式：

- **Lite**: 直接寫碼 + 寫測試
- **Standard**: 進入 [01-spec-gate.md](./01-spec-gate.md) 撰寫規格
- **Full**: 進入 [01-spec-gate.md](./01-spec-gate.md) 完整三關流程
